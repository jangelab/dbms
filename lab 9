create table order1(
orderid varchar(10),
constraint order_pk primary key(orderid)
);

create table author(
aid varchar(10),
aname varchar(10),
acity varchar(10),
acountry varchar(10),
constraint author_pk primary key(aid)
);

create table publisher(
pid varchar(10),
pname varchar(10),
pcity varchar(10),
pcountry varchar(10),
constraint publisher_pk primary key(pid)
);

create table book(
bid varchar(10),
btitle varchar(10),
byop number,
aid varchar(10),
pid varchar(10),
constraint book_pk primary key(bid),
constraint book_fk1 foreign key(aid) references author(aid),
constraint book_fk2 foreign key(pid) references publisher(pid)
);

create table order_book(
orderid varchar(10),
bid varchar(10),
constraint ob_pk primary key(orderid,bid),
constraint ob_fk1 foreign key(bid) references book(bid),
constraint ob_fk2 foreign key(orderid) references order1(orderid)
);


insert into order1 values('1');
insert into order1 values('2');

insert into author values('1','a','b','c');
insert into author values('2','a','b','c');

insert into publisher values('1','a','b','c');

insert into book values('1','abc','2001','1','1');
insert into book values('2','xyz','2001','1','1');
insert into book values('3','mno','2001','2','1');

insert into order_book values('1','1');



select a.aname,count(*)
from author a,book b
where a.aid=b.aid
group by a.aname,b.aid
having count(*)>=all(select count(*)
from book b
group by b.aid);



select b.*
from book b, publisher p
where b.byop='2001' and p.pid=b.pid and p.pname='a';


create or replace trigger trr9
before insert on book
for each row
declare
sy number;
begin
select to_char(sysdate,'YYYY') into sy from dual;
if(:NEW.byop!=sy) then
raise_application_error(-20009,'Cannot insert');
end if;
end;
/

insert into book values('4','mno','2001','2','1');


create or replace procedure prr9(yp number,an varchar)
is
X book%rowtype;
cursor c is select b.* from book b,author a where a.aname=an and b.byop=yp and a.aid=b.aid;
begin
sys.dbms_output.put_line('BOOK DETAILS');
for X in c loop
sys.dbms_output.put_line(X.bid||' '||X.btitle||' '||X.byop);
end loop;
end;
/
set serveroutput on;
exec prr9('2001','a');
